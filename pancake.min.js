function Pancake(e,t,n){if(e){if(window===this)return new Pancake(e,t,n);typeof t=="object"&&(n=t,t=""),typeof n!="object"&&(n={}),n.format&&(t=n.format,delete n.format),typeof e=="string"&&(this.id=e,e=document.getElementById(e));if(e){!this.id&&typeof e.id=="string"&&e.id.length&&(this.id=e.id);if(e.tagName.toLowerCase()==="svg"){this.canvas=document.createElement("canvas"),this.canvas.width=this.width=e.scrollWidth,this.canvas.height=this.height=e.scrollHeight;var r=document.createElement("div");r.appendChild(e.cloneNode(!0)),canvg(this.canvas,r.innerHTML,{ignoreMouse:!0,ignoreAnimation:!0})}e.tagName.toLowerCase()==="canvas"&&(this.canvas=e.cloneNode(!0),this.width=this.canvas.width,this.height=this.canvas.height);if(!this.canvas)throw"Supplied element must be a <canvas> or <svg> element.";this.format=typeof t=="string"&&t.match(/^(image\/)?(png|webp|jpe?g)$/i)?t.toLowerCase().replace(/^image\//,"").replace("jpeg","jpg"):"png",this.src=this.canvas.toDataURL("image/"+this.format.replace("jpg","jpeg")),this.element=document.createElement("img"),this.element.src=this.src,this.height&&(this.element.height=this.height),this.width&&(this.element.width=this.width);for(var i in n)i.toLowerCase()!="src"&&this.element.setAttribute(i,String(n[i]));delete this.canvas}return this}throw"No valid element or element ID supplied."}Pancake.prototype={replace:function(e){typeof e=="string"&&(e=document.getElementById(e));if(!e||!this.element)throw"No valid element or element ID supplied.";return e.parentNode.insertBefore(this.element,e.nextSibling),e.parentNode.removeChild(e),this},download:function(e){if(typeof e!="string"||!e.length)this.id?e=this.id+"."+this.format:e="image."+this.format;var t=document.createElement("a");t.href=this.src,t.setAttribute("download",e),document.body.appendChild(t);if(typeof t.click=="function")t.click();else{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}return document.body.removeChild(t),this}}